회원가입 탈퇴 정보수정 변경
접근제한
전부 crud
가입 탈퇴 수정 변경
프로필

유저모델 커스톰 해서 바로 사용못함?
왱>
이건 모델 폼인디
사용자 정보를 db에 저장하고 그다음 유저에 대한 모델이 작성이 되어있는데 모델이 그대로 폼을 만드는 형태인 모델폼이 된다
기본적으로 유저크리에이션 모델은 유저가 되는디
유저는 장고 기본유저임
model=user
장고 기본유저
장고 디폴트 유저가 모델정보로 설정이 되어있음
근데 유저를 커스톰 하면 장고 기본 유저를 사용하는게 아니고 장고기본유저를 사용하지 않음
즉
요거를 사용하지 않고
요 모델 정보가 바뀌어야함

그래서 이 모델을 새롭게 등록해야함
usercusrom 모델을 새롭게 등록해야함!
그래서 유저 크리에션 폼도 커스텀을 했어씅ㅁ
usercreationform도 
유저 커스텀 때문에 잘 나오는거 같지만 저장할때는 저런 에러가 발생함

디폴트값
바뀌어서 사용할수 가 없다라고 나온다능
usermodel이 커스텀이 되었구낭
그러면?!
기존 기본 유저 모델을 바꿔야겠꾸낭


이건 에러 메세지가 확실하게 알려주기 때문에 변경만 해주면 되는디
어케 변경하느냐??
오버라이딩
을 하겠음
해성~
기존의 유저 크리에이션 폼을 불러와서 재 정의를 하도록 하면 되겠음
일단은?
이 메세지를 잘 기억하고
이게 기존 정보임
얘를 대체한 유저 모델로 변경할 필요가 있다
유저를 바꿨을때 다시 작성하는 폼이 2가지가 존재하고 creation회원가입 change 회원변경
둘다 유저 모델을 사용하는 모델폼이라 메타클래스의 모델 정보를 바꿔줘야함
허거덩 어렵당
user 커스톰 하면 변경할 폼 두가지!
회원가입해야하니까 반드시해야함
model만 변경하면 되기때문에 기존 것은 유지
그래서 어캄?
creationform에 메타클래스도 상속 받으면 model만 변경하고 기존은 유지 가된다능
상속만 잘 받아주면 되고 user에 대하 정보를 불러와야하느네 from .models import user는 하지 않음
왜냐면 폼이 호출되는 시점이랑 클래스가 생성되는 시점이 다를 수 있기 때문에 요 모델에서 유저를 직접 이모트하지 않음

코딩 실행 순서로 인해
에러가 발생할수가 있음
발생 가능성이 있음
에러가 발생을 하지 않을건데
ㄱㄴ데 가끔가다가 에러 발생할 가능성이 있기 때문에 얘를 직접적을 ㅗ임포트해서 사용하지는 않고 현재 활성화된 현재 프로젝트에서 활성화된 실제 사용되는 model을 가지고 오는 함수가 get_user_model()이라는 함수가 있ㅇㅁ
실제 사용되는 model을 리턴하는 함수를 사용한다??
어렵당..!
custom 한 줄 알았는데 auth_user모델에 등록안하면 활성화를 못하는뎅! 이런 실수를 줄여주는게 get_user_model()
!
홍행
user모델사용해야한다?
get_user_model()

usermodel을 임포트 하는 방법은 사용하지 않음
반드시 get user model로 이걸 사용한다

유저모델 참조하지 않는 이유는 저게 자ㅗㅇ을 ㅗ반환해주기 때문
장고에서도 저걸 사용해ㅓㅅ 참조한다고 강좌고 있음
user model에 대한 자세한 내용은 수욜아님 목욜쯤 나오게 됨
이때 1:N관계 다루면서 내가 작성한 누군가가 작성한 게시글을 다룰 예정
이건 나중에 나온다
해서 커스톰 하는 방법은 다음과 같다
model정보만 바ㅜ꺼주면 되고 전부다 상속받아서 기존것을 유지한다
get user model 이라는 함수를 사용해서 return 값을 ...어쩌궁...
회원가입 로직 같은 건 일반적으로 알고있는 모델 폼 사용한 ㅎ영태와 동일ㅎ마
이건 뭐 따로 특별한게 없고 커스톰한거 폼으로 사용하고 나머지는 다 독같음
create로직과 동일함
user를 들리트하는 과정이고 그ㅑㅇ 저렇게 들리트 하면 된다
delete()
회원 탈퇴
로그인한 유저 정보는 request.user안에 들어있음
로그인을 하면 자동으로 여기에 유저 정보를 넣어줌 딸 ㅗdb에서 찾을 필요는 없음
로그인하면 넣어줌
록인하지 않으면 어떤값?
AnonymousUser가 들어있음
어나니머스유저면 로그인 안되어있는 상태
들리트가 db에서 삭제
삭제도 db에 내용이 바뀌는 거라 post 요청으로 보내야함
홍행...
좀더 간단하게?단단하ㅔ?
만들라면 if request. method == POST 일때만 삭제할 수 잇따면 좀 더 단단하게 된당
request post도 좋고
if request도 좋고
엥?
ㅑㄹ request user authetication 확인하는 if 문과 post 요청인것을 확인하는 if 문
이거 두개를 여기 추가해주면 ㅎ좀 더 확실한 로직인 된다

로그아웃 호출까지 해주면 완벽함
change model 정보와 필드 정보도 둘 다 변경을 해줘야함 사용자가 직접 컨트롤 하지 말아야하는 인자까지 컨트롤 할 수 있기 때문에 모델정보와 필드 정보 이 두개를 챙길 수 있어야함
회원정보 고치라는데 내 아이디를 바꿔라?
ㅂ문ㄴ제가 있당
나를 관리자로 만드는 것도 문제가 있당
user 정보를 업데이트 할때는 요거 두개는 튜플 리스트 둘 다 사용가능함
둘다 사용가능 가능~
이래서 유저 체인지 폼을 딱 수정해 보면 이렇게 보일 거고 업데이트 로직과 동일함
crud에서 업데이트 로직과 동일하고 create와 업데이트의 차이는?기존 유저 정보를 넣어줘야함
얘를 넣어주지 않으면 제대로 수정이 안된다
기존 유저 정보를 반드시 넣어주어야함
유저정보는 항상 request.user에 들어있음
어떻게 찾았는지 기억이 안날 수 없음
로그인하면 어쩌구 저쩌구
로그인한 유저정보가 들어이따

비밀번호 변경은
passwordchangeform 쓰면되ㅡㄴ디
회원 정 보 수정에서 thisform 이라는 링크가 생기능ㄴ데
accounts 의 password라고 되어있었는데 더 불편하게 바꾸어버림...
바보들....
패스워드 로직을 직접 마늗ㄹ어줘야함

이경로에 해당하는 요 주소에 맞겠금
urls.py에서 추가르 해줘야함
이 urls.py가 어디있는 칭구냐?!
settigns에 있는 urslpy에서 요 경로를 추가해야한다
주의주의!
코드를 뜯어보고 직접 바꾸셔야 합니당

다큐멘 테이션 urlspy는 세팅즈 파이에서 추가를 함
비번 변경 주소는 세팅즈 파이에 잇는 urls/py에서 변경을 한다
비번 변경주소는 거기서 변경을 해야하는데 거기다 등록하면 되는디 패턴은 저 패턴과 일치하게 만들면 된다능

주소이기 때문에 appname설정 없음없음
걍 바로 name만 설정해주면 된다
요친구는 모델폼과 사용방법이 좀 다름
비어잇는 폼인데 리퀘스트 인자를 어쩌구
첫번째 인자로 유저정보를 넣어줘야한다는 점
유저정보가 필수당
passwordchangeform은 첫번째 인자로 유저정보가 필수당
첫버재 인자로 유저정보를 넣어야하고
이제 비밀번호 변경 페이지 만들수 있음!
그다음 저장하는 부분은~
첫번째 인자로 유저정ㅇ보 넣어주고 두번째 인자로 입력값을 넣어주면 되고 is vlid 하고 저장해주면 된다
이렇게 하면 비번 변경은 끝남
근데 비밀번호를 변경하면 자동을 ㅗ 로그아웃이 되는디 기존에 있는 세션아이디 값이 변경되기 대문에 기존 세션 정볼르 업데이트 시켜줘야함
업데이트 세션 어스 해쉬라는 친구가 업데이트 해주는 친구임
로그아웃을 무효화 처리하는 필수적인 함수이기 때무넹
필수 필수
update_sessinong_auth_hash
usah
쳐주면 자동완선이 될것
첫번째로는 request정보 들어왔고 두번째 인자로 바로 바뀐 유저정보

폼세이브하고 저걸 호출해주면된다
request,user 바뀐 user 저보
request.usser는 바ㅜ뀌기전
user는 바뀐거
form.save()는 유저정보를 리턴해주는데?!
이건 바뀐거

그러면 ㅇ 리퀘스트값을 리퀘값과 유저를 가지고 세션 정보를 업뎃하게 된다
그래서 비밀번호 변경같은 경우에는 조금 외워야할 친구들이 많다
일단 첫번재로는 passwordform을 쓰고 이 폼을 쓸때는 첫번째 이자로 유저정보 request.user를 사용을 하더라
그다음에 두번째로 바로 업데이트 세션 오스 해쉬를 사용을 하고 이때 1번째 인자는 request, 두번째인자로는 바뀐 유저정보를 넣어줘야한다
그래서 요 부분만 딱 기억해 주ㅕㅁㄴ 된당

인증된 사용자에 대한 접근 제한
인증은 ?
로그인 유무에 대해서 사용자에 대한 접근을 제한하는데
두가지 방법이 있다
하나는 속성을 이요하는 방법이고 하나는 데코레이터를 이용하는 방법이고
이중에서 속성형 이용하는 방법을 기본적으로 외우면 되고 로그인 리콰이어드라는 걸 외우면 됨
is_authenticated authenticated
이 속성 잉ㅇ하는거 기본적으로 외우고이ㅓㄴ
이건 유저모델을 속성이라고 되어있는데 실질적으로 보면 함수당
이걸 깃 장고에서 살펴보면?!
장고의 컨트립의 오스에 모델 가면 확인가능
!
그래서 contoll f눌러서 오센시케ㅣ티드를 보면 함수 보면 @property라는걸 이용해서 속성처럼 사용할수 있겠금 만드는거
이게 항상 거짓인건 어나니머ㅅ ㅡ 유저임

어나니 머스 유저의 이즈는 올웨이스 퍼스...
abstractbaseuser는 true
우저클래스가 제대로 할당된 사애면 true임
로그인 하지않으면 anonymoususer라 false임

상단 
로그인을 하지 않았을때
로그인 회원가입
로그인을 했을때
정보수정 탈퇴 로그아웃

not일때는 not requestuser의 is authenticatied 응??
뭐지??
not은 필요할때
응?

로그인 데코레이터?
로그인이 반드시 필요한 동작에서만 사용

login_required 로그인 되어이삳면?!
오케 아니면 로그인 페이지로 다시간다!!!!
is_authenticaed 둘중 하나를 골라서 사용하면 된당

요 인증된 사용자만 어떤 동작을 할 수 있겠금 작성을 해줘야
사이트가 허점이 없어진다
디버깅 시험에서 나올 수 있음
로그인했는데 로그인 페이지가 보인다면?!!?!?
그렇게 해서는 안된다...

회원가입한다음에 로그인가지 같이하며년 auth_login만 같이 호출해주기
그다음에 삭제와 함께 로그아웃 하는거
절대 순서가 바뀌면 안된다
auth_logout이 request유저정보를 어나니머스유저로 바꾸는 역할을 함

어나니 머스유저로 바뀌고 들리트?
없다고 뜬당
db에서 삭제하고 requestuser에는 아직 내용이 유효하당
request.logout해주면 리퀘스트 안에있는 유저도 저렇게 바뀌어버림
db삭제후 로그아웃 순서를 지켜줘야한다
패스워드 체인지 폼에 유저정보는 무조건 넣어줘야함
헝헝 넘 어려웡

요 유저정보를 첫번째 있어서 필수로 넣어줘야ㅏㄴ다
자세한 내용이 보고 싶다면?!
살펴보시길...
직접 찾아서 들어가는 방법은
django contrib auth forms에 들어잇음


크리에으트와 업데이트 차이
forms.py 기존 폼 상속 커스텀

차이점
비번 첫번째가 request.user라는 것
헉헉 어렵당
